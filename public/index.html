<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" href="style.css" />
	<link rel="shortcut icon" href="#" />

	<title>CG project</title>
</head>

<body>
	<div class="row">
				<div>
					<canvas class="column1" id="screenCanvas" width="900"
						height="700">
					</canvas>
				</div>
		
				<div class="menu column2">
					<div class="title">
						Computer Graphics Project
					</div>
					<p></p>
					<div>
						Project developed for the Computer Graphics course at the University of Bologna.</br>
						AA.2021/22 Department of Information Engineering and Computer Science.
					</div>
					<br>
					<div>
						<label for="Radius">Radius</label>
						<input type="range" name="Radius" id="radius"min="10" max="100" step="1" defaultValue="50">
					</div>
					<div>
						<label for="Phi">Phi</label>
						<input type="range" name="Phi" id="phi"min="-5" max="5" step="0.01" defaultValue="0">
					</div>
					<div>
						<label for="Theta">Theta</label>
						<input type="range" name="Theta" id="theta" min="-5" max="5" step="0.02" defaultValue="0">
					</div>
					<div>
						<fieldset>
							<legend>Trasparenza</legend>
						
							<div>
							  <input type="checkbox" id="cx" name="Parete Cx">
							  <label for="Parete Cx">Parete Cx</label>
							</div>
						
							<div>
							  <input type="checkbox" id="dx" name="Parete Dx">
							  <label for="Parete Dx">Parete Dx</label>
							</div>

							<div>
								<input type="checkbox" id="sx" name="Parete Sx">
								<label for="Parete Sx">Parete Sx</label>
							  </div>
						</fieldset>
						<div>
							Premi W/S per muoverti in avanti/indietro<br/>
							Premi A/D per muoverti a sinistra/destra<br/>
							Premi Q/E per muoverti in alto/basso<br/>
							Premi G/K per ruotare a destra/sinistra<br/>
							Premi U/J per ruotare in alto/basso<br/>
							Premi le frecce per muovere la visuale: alto/basso/sinistra/destra<br/>
							Premi H per nascondere il pannello di interazione<br/>
							Premi R per resettare l'inclinazione<br/>
							Premi il tasto sinistro e trascina il mouse per ruotare la scena<br>
							Premi la rotellina del mouse per zoomare<br/>
						</div>
					<div> <input type="checkbox" label="lookAt" id="lookat">
						<label for="lookat">Punta la telecamera verso il centro</label></div>
						<select name="LookAt" id="selectLookat" disabled></select>
			</div>
</body>

<!-- vertex shader -->
<script id="3d-vertex-shader" type="x-shader/x-vertex">
	attribute vec4 a_position;
	attribute vec3 a_normal;
	attribute vec2 a_texcoord;

	uniform mat4 u_projection;
	uniform mat4 u_view;
	uniform mat4 u_world;
	uniform vec3 u_viewWorldPosition;

	varying vec3 v_normal;
	varying vec3 v_surfaceToView;
	varying vec2 v_texcoord;

	void main() {
		vec4 worldPosition = u_world * a_position;
		gl_Position = u_projection * u_view * worldPosition;
		v_surfaceToView = u_viewWorldPosition - worldPosition.xyz;
		v_normal = mat3(u_world) * a_normal;
		v_texcoord = a_texcoord;
	}
</script>

<!-- fragment shader -->
<script id="3d-fragment-shader" type="x-shader/x-fragment">
	precision highp float;

	varying vec3 v_normal;
	varying vec3 v_surfaceToView;
	varying vec2 v_texcoord;

	uniform vec3 diffuse;
	uniform vec3 ambient;
	uniform vec3 emissive;
	uniform vec3 specular;
	uniform float shininess;
	uniform float opacity;
	uniform vec3 u_lightDirection;
	uniform vec3 u_ambientLight;
	uniform vec3 u_colorLight;
	uniform sampler2D diffuseMap;
	uniform float uAlpha;

	void main () {
		vec3 normal = normalize(v_normal);

		vec3 surfaceToViewDirection = normalize(v_surfaceToView);
		vec3 halfVector = normalize(u_lightDirection + surfaceToViewDirection);

		float fakeLight = dot(u_lightDirection, normal) * .5 + .5;
		float specularLight = clamp(dot(normal, halfVector), 0.0, 1.0);

		vec4 diffuseMapColor = texture2D(diffuseMap, v_texcoord);
		vec3 effectiveDiffuse = diffuse * diffuseMapColor.rgb * u_colorLight.rgb;
		float effectiveOpacity = opacity * diffuseMapColor.a;

		gl_FragColor = vec4(
			emissive +
			ambient * u_ambientLight +
			effectiveDiffuse * fakeLight +
			specular * pow(specularLight, shininess),
			uAlpha * effectiveOpacity);
	}
</script>

<!-- Libreria -->
<script type="text/javascript" src="./JS/JSCourse/glm_utils.js"></script>
<script type="text/javascript" src="./JS/JSCourse/jquery-3.6.0.js"></script>
<script type="text/javascript" src="./JS/JSCourse/m4.js"></script>
<script type="text/javascript" src="./JS/JSCourse/mesh_utils.js"></script>
<script type="text/javascript" src="./JS/JSCourse/webgl-utils.js"></script>
<script type="text/javascript" src="./JS/JSCourse/load_mesh.js"></script>

<script type="module" src="./JS/main.js"></script>

</html>